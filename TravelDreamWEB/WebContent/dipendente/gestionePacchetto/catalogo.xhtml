<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pf="http://xmlns.jcp.org/jsf/passthrough">

<ui:composition template="../template.xhtml">

	<ui:define name="content">

		<h:link outcome="aggiungiInfoGenerali"
			class="btn btn-default pull-right" value="Aggiungi nuovo pacchetto" />
		<br />

		<h:form id="form">
		
			<p:growl id="messages" showDetail="true" />

			<p:dataTable var="pacchetto" value="#{pacchettoBean.pacchetti}"
				id="pacchettiTable"  editable="true">
				
				<p:ajax event="rowEdit" listener="#{pacchettoBean.onEdit}"
					update=":form:messages" />
				<p:ajax event="rowEditCancel" listener="#{pacchettoBean.onDelete}"
					update=":form:messages" />
					
				<p:column headerText="Nome" sortBy="nome">
						<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{pacchetto.nome}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{pacchetto.nome}" style="width:100%" />
								</f:facet>
						</p:cellEditor>						
				</p:column>

				<p:column headerText="Localita" sortBy="year">
					<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{pacchetto.localita}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{pacchetto.localita}" style="width:100%" />
								</f:facet>
					</p:cellEditor>	
				</p:column>

				<p:column headerText="Descrizione">
					<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{pacchetto.descrizione}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{pacchetto.descrizione}" style="width:100%" />
								</f:facet>
					</p:cellEditor>	
				</p:column>

				<p:column headerText="Inizio validità" sortBy="inizioValidita">
					<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{pacchetto.inizioValidita}" >
										<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
									</h:outputText>
								</f:facet>
								<f:facet name="input">
									<p:calendar value="#{pacchetto.inizioValidita}" pattern="MM/dd/yyyy HH:mm" />
								</f:facet>
					</p:cellEditor>							
				</p:column>

				<p:column headerText="Fine validità" sortBy="fineValidita">
					<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{pacchetto.fineValidita}">
											<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
									</h:outputText>
								</f:facet>
								<f:facet name="input">
									<p:calendar value="#{pacchetto.fineValidita}" pattern="MM/dd/yyyy HH:mm" />
								</f:facet>
					</p:cellEditor>	
				</p:column>
			
				<p:column>
					
						<p:cellEditor>	
							<f:facet name="output">
									<p:commandButton id="basic" value="Voli" type="button" styleClass="btn white">
										<p:ajax listener="#{pacchettoBean.mostraInfo(event,pacchetto)}"
										update=":form:displayAndata,:form:displayRitorno"
										oncomplete="PF('andataDialog').show();" />
									</p:commandButton>
									
								</f:facet>
							<f:facet name="input">								
									<p:commandButton id="basic2" value="Edit" type="button" styleClass="btn-danger">
										<p:ajax listener="#{pacchettoBean.mostraInfo(event,pacchetto)}"
										update=":form:displayAndata2,:form:displayRitorno2"
										oncomplete="PF('andataDialog2').show();" />
									</p:commandButton>
									
									<p:commandButton id="basic3" value="Add" type="button" styleClass="btn-danger">
										<p:ajax listener="#{pacchettoBean.goToAddVoloNuovo(event,pacchetto)}"
										update=":form:form2:addVoloNuovoForm"
										oncomplete="PF('addVoloNuovo').show();" />
									</p:commandButton>
							</f:facet>
						</p:cellEditor>
								
						
				</p:column>
				
				<p:column style="width:6%">
					<p:rowEditor />
				</p:column>
				
			</p:dataTable>


			<p:dialog header="Voli" widgetVar="andataDialog" resizable="false" >

				<p:dataTable id="displayAndata" var="volo"
					value="#{pacchettoBean.pacchettoDaVisualizzareDto.voliAndata}">
					<f:facet name="header"> Andata </f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo.costo} €" />
					</p:column>
					
					

				</p:dataTable>

				<p:dataTable id="displayRitorno" var="volo_r"
					value="#{pacchettoBean.pacchettoDaVisualizzareDto.voliRitorno}">
					<f:facet name="header">Ritorno</f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo_r.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo_r.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo_r.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo_r.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo_r.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo_r.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo_r.costo} €" />
					</p:column>

				</p:dataTable>


			</p:dialog>
		
			
			<p:dialog header="Voli edit" widgetVar="andataDialog2" resizable="false">
		
				<p:dataTable id="displayAndata2" var="volo"
					value="#{pacchettoBean.pacchettoDaVisualizzareDto.voliAndata}">
					<f:facet name="header"> Andata </f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo.costo} €" />
					</p:column>
					
					<p:column>
						<h:commandLink id="eliminaAndata" value="Elimina"
							class="btn btn-danger white"
							action="#{pacchettoBean.eliminaVoloAndataDaPacchetto(action,volo)}">
							<f:ajax execute="eliminaAndata" render="displayAndata2" />
						</h:commandLink>
					</p:column>

				</p:dataTable>

				<p:dataTable id="displayRitorno2" var="volo_r"
					value="#{pacchettoBean.pacchettoDaVisualizzareDto.voliRitorno}">
					<f:facet name="header">Ritorno</f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo_r.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo_r.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo_r.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo_r.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo_r.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo_r.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo_r.costo} €" />
					</p:column>
					
					<p:column>
						<h:commandLink id="eliminaRitorno" value="Elimina"
							class="btn btn-danger white"
							action="#{pacchettoBean.eliminaVoloRitornoDaPacchetto(action, volo_r)}">
							<f:ajax execute="eliminaRitorno" render="displayRitorno2" />
						</h:commandLink>
						
					</p:column>

				</p:dataTable>


			</p:dialog>
			
			<p:dialog header="Aggiungi Volo Nuovo" widgetVar="addVoloNuovo" resizable="false"  >
			
			
			<h:form id="form2" >
			<p:panel id="addVoloNuovoForm">
			<div class="form-group">
				<label>Citta Partenza:</label>
				<h:inputText pf:placeholder="Inserisci la città di partenza"
					class="form-control" placeholder="Inserisci la città di partenza"
					value="#{pacchettoBean.volo.cittaPartenza}" />
			</div>

			<div class="form-group">
				<label>Citta Arrivo:</label>
				<h:inputText pf:placeholder="Inserisci la città di arrivo"
					class="form-control" value="#{pacchettoBean.volo.cittaArrivo}" />
			</div>

			<div class="form-group">
				<label>Nome Compagnia:</label>
				<h:inputText pf:placeholder="Inserisci il nome della compagnia"
					class="form-control" value="#{pacchettoBean.volo.nomeCompagnia}" />
			</div>

			<div class="form-group">
				<label>Data partenza :</label> <br />
				<p:calendar value="#{pacchettoBean.volo.partenza}"
					pattern="MM/dd/yyyy HH:mm" />
			</div>

			<div class="form-group">
				<label>Data arrivo:</label> <br />
				<p:calendar value="#{pacchettoBean.volo.arrivo}"
					pattern="MM/dd/yyyy HH:mm" />
			</div>

			<div class="form-group">
				<label>Disponibilità:</label>
				<h:inputText
					pf:placeholder="Inserisci il numero di posti disponibili"
					class="form-control" value="#{pacchettoBean.volo.disponibilita}" />
			</div>

			<div class="form-group">
				<label>Costo:</label>
				<h:inputText pf:placeholder="Inserisci il costo" class="form-control"
					value="#{pacchettoBean.volo.costo}" />
			</div>

			<p:selectOneRadio value="#{pacchettoBean.tipoVolo}">
				<f:selectItem itemValue="Andata" itemLabel="Andata" />
				<f:selectItem itemValue="Ritorno" itemLabel="Ritorno" />
			</p:selectOneRadio>

			<p:commandButton value="Aggiungi" styleClass="btn btn-default"
				action="#{pacchettoBean.addVoloNuovo()}" oncomplete="PF('addVoloNuovo').hide();"/>
			
		</p:panel>	
		</h:form>
		
		</p:dialog>	
			

	
		</h:form>
	<script>
			jQuery.noConflict();
		</script>

<script>
			$(function() {
				$('.active').removeClass('active');
				$('.nav li:nth-child(2)').addClass('active');
			});
		</script>

	</ui:define>

</ui:composition>


</html>